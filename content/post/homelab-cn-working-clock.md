---
author: Ryo
title: iOS中国大陆工作日闹钟
description: "iOS中国大陆工作日闹钟"
tags: ["iOS", "快捷指令"]
projects: ["homelab"]
---

# 简述

使用数据来自

- Apple 官方[中国节假日](https://calendars.icloud.com/holidays/cn_zh.ics)日历 (半线上方案)
- [cn_working_day](https://github.com/RyoLee/cn_working_day) 项目 (线上方案)

半线上方案使用 Apple 官方中国节假日日历数据判断,不需要频繁联网同步 **推荐使用**

线上方案使用 cn_working_day 数据,使用 Github action 基于[workalendar](https://github.com/workalendar/workalendar) 自动生成近 30 天工作日信息

# 已知 BUG

- 快捷指令无法操作健康添加的就寝闹钟: ios bug 待官方修复

# 半线上方案

## 导入&设定

[快捷指令-中国大陆节假日闹钟](https://www.icloud.com/shortcuts/0b37a6ad0a734149b24a45250998accc)

导入后编辑快捷指令第 3/8 行,手动选择对应的闹钟并保存

## 自动化

为防止快捷指令运行异常时未能开启闹钟,这里参考被动安全概念,即通过复数个自动化任务先在每天凌晨无条件开启闹钟,再通过本快捷指令判断是否为休息日关闭

建议在每天 `00:01` `00:02` `00:03` 添加三个自动化执行开启闹钟,再在 `01:00` `02:00` `03:00` 添加三个自动化执行本快捷指令,6 个任务均关闭运行前询问,关闭运行时通知

# 线上方案

## 导入&设定

iOS 工作日闹钟[快捷指令-工作日闹钟](https://www.icloud.com/shortcuts/5ff1633342da40b4951e87c8551a0aa7)

当前版本 v1.1 已更新数据 URL

使用该快捷指令需配置 2 个闹钟,分别对应工作日和休息日,再编辑快捷指令找到如下部分,分别点击"工作日"/"休息日"改为需要的闹钟

- [打开]闹钟"工作日"
- [打开]闹钟"休息日"

因闹钟可能不存在或未配置闹钟名,[打开]闹钟可能会显示异常,请手动修改打开闹钟"工作日"/"休息日"为对应闹钟

**请不要修改后面的部分,后面的关闭部分除非你要删除休息日闹钟,否则不需要手动修改**

## 不需要休息日闹钟？

如果休息日想睡懒觉不需要闹钟,则删除以下 2 项

- [打开]闹钟"休息日"
- [关闭]闹钟"休息日闹钟"

## 自动化

~~自动化可以自行选择方案,比较常见的是在 快捷指令-自动化-创建个人自动化-打开"勿扰模式"模式时 添加运行本快捷指令利用勿扰模式触发自动运行~~

~~勿扰模式在 设置-专注模式-勿扰模式-自动打开 处添加 每天 00:10-06:00 配置,即可实现全自动触发~~

最新版本上已支持定时无操作触发,勿扰方式是旧版的老黄历了

新版直接如下操作即可:

快捷指令-->自动化-->"+"-->创建个人自动化-->特定时间-->修改时间(注意要在 0 点以后)并下一步-->添加操作-->运行快捷指令-->点选运行"工作日闹钟"并下一步-->**取消勾选运行前询问**-->完成

如果没有取消勾选运行前询问则为老版本,需要继续使用勿扰来绕过

## 其他

1. 首次运行时会询问是否运行访问数据源网站,需要手动允许一次才能自动运行,不然会卡住
2. 可以通过添加多个自动化的方式防止访问数据源失败(如工作日/休息日闹钟分别为 07:00/09:32,可以在 1/3/5 点分别加一个)
3. **请求数据失败时,两个闹钟都会开启**
